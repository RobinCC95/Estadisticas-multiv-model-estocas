---
title: "Practica III"
author: "Robinson Aldair Cuayal"
date: "2023-03-11"
output: word_document
lang: es-ES
toc: TRUE
---

\newpage

# Punto 1

El ejercicio en cuestión implica la realización de un análisis de regresión para determinar si existe
una relación entre el nivel de plomo en el suelo y la categoría del individuo, y si el nivel de plomo
en el suelo es un factor significativo para predecir los niveles altos de plomo en la sangre de los niños. 
Se proporcionan la hipótesis nula y la alternativa, así como los valores de p, la ecuación de regresión y 
las estadísticas relevantes. El objetivo principal es predecir los niveles altos de plomo en la sangre de los niños. 
Como primer paso, se va a almacenar la informacion de las tablas en un excel para luego ser cargado y convertido a un 
dataframe en R.

```{r}
library(readxl)
datos = data.frame(read_excel("dataset_ejer1.xlsx"))
dim(datos)
head(datos)
```
Con la carga de los datos, como segundo paso se implementa el modelo de regresion logistica. Cabe resaltar que 
es importante especificar el tipo de enlace en la modelación logística ya que afecta directamente la interpretación 
de los coeficientes del modelo y los resultados obtenidos.
```{r}
# Crear la regresión logística
modelo_logistico = glm(
  Categoria_del_Individuo ~ Nivel_plomo_suelo,
  data = datos,
  family = binomial(link = "logit")
)
#modelo general
summary(modelo_logistico)

# Obtener la razón de grados de probabilidad
coeficientes = coef(modelo_logistico)
razon_encontrada = exp(coeficientes["Nivel_plomo_suelo"])
razon_encontrada
# Compara la razón de grados de probabilidad contra la que obtuvieron los autores (14.25)
razon_autores = 14.25
# Realizar la prueba de significancia
summary(modelo_logistico)$coefficients["Nivel_plomo_suelo", "Pr(>|z|)"]

```

La razón de grados de probabilidad obtenida es de 1.002, lo que indica que por cada diez veces que aumenta el nivel de
plomo en la tierra, la proporción relativa de casos con respecto a los grupos de control aumenta en un 0.1. 
Este resultado difiere del obtenido por los autores del estudio (14.25).
El valor de p obtenido es $4.601328*10^{-07}$, lo que indica que el nivel de plomo en la tierra es un factor significativo para 
predecir los niveles altos de plomo en la sangre de los niños. \n
Las grafica del modelo es el siguiente
```{R}
library(ggplot2)
ggplot(data = datos, aes(x = Nivel_plomo_suelo, y = Categoria_del_Individuo)) +
  geom_point(aes(color = as.factor(Categoria_del_Individuo)), shape = 1) +
  stat_function(fun = function(x){predict(modelo_logistico,
                                          newdata = data.frame(Nivel_plomo_suelo = x),
                                          type = "response")}) +
  theme_bw() +
  labs(title = "Regresión logística",
       y = "Probabilidad plomo en niños") +
  theme(legend.position = "none")

```

## Preguntas

a) La variable dependiente es la "Categoria_del_Individuo".
b) La variable independiente es la "Nivel_plomo_suelo".
c) Hipótesis nula: No hay relación entre el nivel de plomo en el suelo y la categoría del individuo. \n
Hipótesis alternativa: Existe una relación entre el nivel de plomo en el suelo y la categoría del individuo.
d) La hipótesis nula es rechazada debido a que el valor de p obtenido $4.601328*10^{-07}$ es menor al nivel de 
significancia del 0.05 establecido. Esto indica que hay suficiente evidencia para concluir que el nivel de plomo 
en el suelo es un factor significativo para predecir los niveles altos de plomo en la sangre de los niños.
e) El objetivo más relevante es predecir los niveles altos de plomo en la sangre de los niños, ya que esto puede 
tener graves consecuencias en su salud. Aunque la estimación de parámetros es importante para comprender la relación 
entre las variables, la predicción tiene una mayor importancia práctica.
f) La población muestreada son niños expuestos al plomo en la ciudad donde se realizó el estudio.
g) La población objetivo son todos los niños expuestos al plomo, independientemente de su ubicación geográfica.
h) La variable "Nivel_plomo_suelo" está relacionada directamente con la "Categoria_del_Individuo", ya que aumentos en la 
primera variable son predictores de una mayor proporción de casos en la segunda variable,
al examinar la significación estadística de los coeficientes de la regresión y de las variables incluidas al ser significativo y positivo.
Los datos no tienen una alta correlacion segun el Nab pero al tener los resultado del modelo de regresion logistica
hay que tener en cuenta el primer enunciado.
```{R}
r = cor(datos)
nab = 1-det(r)
nab
```
i) La ecuación de regresión es: $y = b0 + b1x$, donde "y" es la "Categoria_del_Individuo", "x" es la "Nivel_plomo_suelo", 
b0 es el intercepto y b1 es la pendiente. En este caso, la ecuación sería: 
$Categoria_del_Individuo = -1.516206 + 0.002743*Nivel_plomo_suelo$.
j) Para realizar otro analisis adicionando valores puede ser el del sexo que pueden tomar como masculino (1) y 
femenino (0).
k) La variable "Categoria_del_Individuo" es categórica binaria (0 para control y 1 para caso), mientras 
que la variable "Nivel_plomo_suelo" es cuantitativa. 
La razón de grados de probabilidad (también conocido como odds ratio) es una medida de la asociación 
entre dos eventos.
La variable sexo tambien es categórica binaria.
diferentes valores de la variable independiente.
l) Con base en el punto (j) donde se le puede dar valores de nuestra parte a la variable de sexo de los niños, 
se diseña el modelo modelo logistico para el siguiente analisis estadistico.
```{R}
#codigo modelo 2 aqui
```


# Punto 2


```{r}
library(readxl)
datos <- data.frame(read_excel("dataset_ejer_2.xlsx"))
dim(datos)
```

# Punto 3

```{r}
library(readxl)
datos <- data.frame(read_excel("dataset_ejer_3.xlsx"))
dim(datos)
```

# Punto 4

```{r}
cat('hola')
```

# Punto 5

```{r}
cat('hola')
```